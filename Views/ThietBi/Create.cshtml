@model phonev2.Models.ThietBi

@{
    ViewData["Title"] = "Th√™m Thi·∫øt B·ªã M·ªõi";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<!-- Header -->
<div class="row mb-3">
    <div class="col-md-6">
        <h2 class="text-success">
            <i class="fas fa-plus-circle me-2"></i>@ViewData["Title"]
        </h2>
        <p class="text-muted">Th√™m thi·∫øt b·ªã m·ªõi v√†o h·ªá th·ªëng</p>
    </div>
    <div class="col-md-6 text-end">
        <a asp-action="Index" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i>Quay l·∫°i danh s√°ch
        </a>
    </div>
</div>

<!-- Hi·ªÉn th·ªã th√¥ng b√°o l·ªói -->
@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        <strong>C√≥ l·ªói x·∫£y ra!</strong> Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin nh·∫≠p v√†o.
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<!-- Form th√™m thi·∫øt b·ªã -->
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-mobile-alt me-2"></i>Th√¥ng tin thi·∫øt b·ªã
                </h5>
            </div>
            <div class="card-body">
                <form asp-action="Create" method="post" novalidate>
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                    <!-- Kh√°ch h√†ng -->
                    <div class="row mb-3">
                        <label asp-for="MaKhachHang" class="col-sm-3 col-form-label">
                            <i class="fas fa-user me-1"></i>Kh√°ch h√†ng <span class="text-danger">*</span>
                        </label>
                        <div class="col-sm-9">
                            <select asp-for="MaKhachHang" class="form-select" asp-items="ViewBag.KhachHangList">
                                <option value="">-- Ch·ªçn kh√°ch h√†ng --</option>
                            </select>
                            <span asp-validation-for="MaKhachHang" class="text-danger"></span>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Ch·ªçn kh√°ch h√†ng s·ªü h·ªØu thi·∫øt b·ªã n√†y
                            </div>
                        </div>
                    </div>

                    <!-- T√™n thi·∫øt b·ªã -->
                    <div class="row mb-3">
                        <label asp-for="TenThietBi" class="col-sm-3 col-form-label">
                            <i class="fas fa-tag me-1"></i>T√™n thi·∫øt b·ªã <span class="text-danger">*</span>
                        </label>
                        <div class="col-sm-9">
                            <input asp-for="TenThietBi" class="form-control" placeholder="V√≠ d·ª•: iPhone 15 Pro Max, MacBook Air M2">
                            <span asp-validation-for="TenThietBi" class="text-danger"></span>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Nh·∫≠p t√™n chi ti·∫øt c·ªßa thi·∫øt b·ªã
                            </div>
                        </div>
                    </div>

                    <!-- Lo·∫°i thi·∫øt b·ªã -->
                    <div class="row mb-3">
                        <label asp-for="LoaiThietBi" class="col-sm-3 col-form-label">
                            <i class="fas fa-list me-1"></i>Lo·∫°i thi·∫øt b·ªã <span class="text-danger">*</span>
                        </label>
                        <div class="col-sm-9">
                            <select asp-for="LoaiThietBi" class="form-select">
                                <option value="">-- Ch·ªçn lo·∫°i thi·∫øt b·ªã --</option>
                                <option value="ƒêi·ªán tho·∫°i">üì± ƒêi·ªán tho·∫°i</option>
                                <option value="Laptop">üíª Laptop</option>
                            </select>
                            <span asp-validation-for="LoaiThietBi" class="text-danger"></span>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Ch·ªçn lo·∫°i thi·∫øt b·ªã: ƒêi·ªán tho·∫°i ho·∫∑c Laptop
                            </div>
                        </div>
                    </div>

                    <!-- H√£ng s·∫£n xu·∫•t -->
                    <div class="row mb-3">
                        <label asp-for="HangSanXuat" class="col-sm-3 col-form-label">
                            <i class="fas fa-building me-1"></i>H√£ng s·∫£n xu·∫•t
                        </label>
                        <div class="col-sm-9">
                            <input asp-for="HangSanXuat" class="form-control" placeholder="V√≠ d·ª•: Apple, Samsung, Dell, HP, Asus">
                            <span asp-validation-for="HangSanXuat" class="text-danger"></span>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Nh·∫≠p t√™n h√£ng s·∫£n xu·∫•t thi·∫øt b·ªã
                            </div>
                        </div>
                    </div>

                    <!-- Model -->
                    <div class="row mb-3">
                        <label asp-for="Model" class="col-sm-3 col-form-label">
                            <i class="fas fa-code me-1"></i>Model
                        </label>
                        <div class="col-sm-9">
                            <input asp-for="Model" class="form-control" placeholder="V√≠ d·ª•: Pro Max, Air M2, Gaming 15">
                            <span asp-validation-for="Model" class="text-danger"></span>
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Nh·∫≠p model/phi√™n b·∫£n c·ª• th·ªÉ c·ªßa thi·∫øt b·ªã
                            </div>
                        </div>
                    </div>

                    <!-- N√∫t h√†nh ƒë·ªông -->
                    <div class="row">
                        <div class="col-sm-9 offset-sm-3">
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save me-1"></i>L∆∞u thi·∫øt b·ªã
                                </button>
                                <button type="reset" class="btn btn-outline-secondary">
                                    <i class="fas fa-undo me-1"></i>Nh·∫≠p l·∫°i
                                </button>
                                <a asp-action="Index" class="btn btn-outline-danger">
                                    <i class="fas fa-times me-1"></i>H·ªßy
                                </a>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Sidebar h∆∞·ªõng d·∫´n -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-lightbulb me-2"></i>H∆∞·ªõng d·∫´n
                </h6>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <h6 class="text-primary">
                        <i class="fas fa-user me-1"></i>Kh√°ch h√†ng
                    </h6>
                    <p class="small text-muted">
                        Ch·ªçn kh√°ch h√†ng s·ªü h·ªØu thi·∫øt b·ªã. N·∫øu ch∆∞a c√≥ trong danh s√°ch, 
                        h√£y th√™m kh√°ch h√†ng m·ªõi tr∆∞·ªõc.
                    </p>
                </div>

                <div class="mb-3">
                    <h6 class="text-primary">
                        <i class="fas fa-mobile-alt me-1"></i>Th√¥ng tin thi·∫øt b·ªã
                    </h6>
                    <p class="small text-muted">
                        Nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin ƒë·ªÉ d·ªÖ d√†ng nh·∫≠n di·ªán thi·∫øt b·ªã khi s·ª≠a ch·ªØa.
                        T√™n thi·∫øt b·ªã n√™n chi ti·∫øt v√† r√µ r√†ng.
                    </p>
                </div>

                <div class="mb-3">
                    <h6 class="text-primary">
                        <i class="fas fa-tags me-1"></i>Lo·∫°i thi·∫øt b·ªã
                    </h6>
                    <ul class="small text-muted mb-0">
                        <li><strong>ƒêi·ªán tho·∫°i:</strong> Smartphone, iPhone, Android</li>
                        <li><strong>Laptop:</strong> M√°y t√≠nh x√°ch tay, Notebook</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quick tips -->
        <div class="card mt-3">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-tips me-2"></i>G·ª£i √Ω nhanh
                </h6>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="fillSamplePhone()">
                        <i class="fas fa-mobile-alt me-1"></i>M·∫´u ƒëi·ªán tho·∫°i
                    </button>
                    <button type="button" class="btn btn-outline-success btn-sm" onclick="fillSampleLaptop()">
                        <i class="fas fa-laptop me-1"></i>M·∫´u laptop
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        $(document).ready(function() {
            // Focus v√†o dropdown kh√°ch h√†ng khi load trang
            $('#MaKhachHang').focus();

            // T·ª± ƒë·ªông focus ƒë·∫øn tr∆∞·ªùng ti·∫øp theo khi ch·ªçn xong
            $('#MaKhachHang').change(function() {
                if ($(this).val()) {
                    $('#TenThietBi').focus();
                }
            });

            // Placeholder ƒë·ªông cho t√™n thi·∫øt b·ªã
            $('#LoaiThietBi').change(function() {
                var loai = $(this).val();
                var placeholder = '';
                
                if (loai === 'ƒêi·ªán tho·∫°i') {
                    placeholder = 'V√≠ d·ª•: iPhone 15 Pro Max, Samsung Galaxy S24 Ultra';
                } else if (loai === 'Laptop') {
                    placeholder = 'V√≠ d·ª•: MacBook Air M2, Dell XPS 15, ASUS ROG Strix';
                } else {
                    placeholder = 'Nh·∫≠p t√™n chi ti·∫øt c·ªßa thi·∫øt b·ªã';
                }
                
                $('#TenThietBi').attr('placeholder', placeholder);
            });

            // Validation khi submit
            $('form').submit(function(e) {
                var isValid = true;
                
                // Ki·ªÉm tra kh√°ch h√†ng
                if (!$('#MaKhachHang').val()) {
                    isValid = false;
                    showError('#MaKhachHang', 'Vui l√≤ng ch·ªçn kh√°ch h√†ng');
                }
                
                // Ki·ªÉm tra t√™n thi·∫øt b·ªã
                if (!$('#TenThietBi').val().trim()) {
                    isValid = false;
                    showError('#TenThietBi', 'Vui l√≤ng nh·∫≠p t√™n thi·∫øt b·ªã');
                }
                
                // Ki·ªÉm tra lo·∫°i thi·∫øt b·ªã
                if (!$('#LoaiThietBi').val()) {
                    isValid = false;
                    showError('#LoaiThietBi', 'Vui l√≤ng ch·ªçn lo·∫°i thi·∫øt b·ªã');
                }
                
                if (!isValid) {
                    e.preventDefault();
                    showAlert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!', 'danger');
                }
            });

            // Clear error khi user nh·∫≠p l·∫°i
            $('input, select').on('input change', function() {
                $(this).removeClass('is-invalid');
                $(this).siblings('.text-danger').text('');
            });
        });

        // H√†m hi·ªÉn th·ªã l·ªói
        function showError(selector, message) {
            $(selector).addClass('is-invalid');
            $(selector).siblings('.text-danger').text(message);
        }

        // H√†m hi·ªÉn th·ªã th√¥ng b√°o
        function showAlert(message, type) {
            var alertHtml = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            $('.row').first().before(alertHtml);
        }

        // ƒêi·ªÅn d·ªØ li·ªáu m·∫´u ƒëi·ªán tho·∫°i
        function fillSamplePhone() {
            $('#TenThietBi').val('iPhone 15 Pro Max 256GB');
            $('#LoaiThietBi').val('ƒêi·ªán tho·∫°i').trigger('change');
            $('#HangSanXuat').val('Apple');
            $('#Model').val('Pro Max');
        }

        // ƒêi·ªÅn d·ªØ li·ªáu m·∫´u laptop
        function fillSampleLaptop() {
            $('#TenThietBi').val('MacBook Air 13 inch M2');
            $('#LoaiThietBi').val('Laptop').trigger('change');
            $('#HangSanXuat').val('Apple');
            $('#Model').val('Air M2');
        }
    </script>
}