# H·ªá Th·ªëng C·∫£nh B√°o T·ªìn Kho - Linh Ki·ªán

## T·ªïng Quan

H·ªá th·ªëng c·∫£nh b√°o t·ªìn kho ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ gi√∫p qu·∫£n l√Ω hi·ªáu qu·∫£ vi·ªác theo d√µi v√† c·∫£nh b√°o khi linh ki·ªán c√≥ t·ªìn kho th·∫•p, ƒë·∫£m b·∫£o kh√¥ng b·ªã gi√°n ƒëo·∫°n kinh doanh.

## C√°c T√≠nh NƒÉng Ch√≠nh

### 1. C·∫£nh B√°o T·ªìn Kho Th·∫•p (`LowStockAlert`)

- **M·ª•c ƒë√≠ch**: Hi·ªÉn th·ªã danh s√°ch linh ki·ªán c√≥ t·ªìn kho ‚â§ ng∆∞·ª°ng c·∫£nh b√°o
- **Truy c·∫≠p**: `/LinhKien/LowStockAlert`
- **T√≠nh nƒÉng**:
  - L·ªçc theo ng∆∞·ª°ng c·∫£nh b√°o (5, 10, 20, 50 c√°i)
  - Ph√¢n lo·∫°i theo m·ª©c ƒë·ªô: H·∫øt h√†ng, S·∫Øp h·∫øt, √çt h√†ng
  - Nh·∫≠p h√†ng nhanh (t·ª´ng linh ki·ªán ho·∫∑c h√†ng lo·∫°t)
  - Xu·∫•t danh s√°ch CSV
  - ƒê·ªÅ xu·∫•t s·ªë l∆∞·ª£ng nh·∫≠p th√™m

### 2. B√°o C√°o T·ªìn Kho (`StockReport`)

- **M·ª•c ƒë√≠ch**: B√°o c√°o t·ªïng quan t·ªìn kho theo lo·∫°i linh ki·ªán
- **Truy c·∫≠p**: `/LinhKien/StockReport`
- **T√≠nh nƒÉng**:
  - Bi·ªÉu ƒë·ªì c·ªôt hi·ªÉn th·ªã t·ªìn kho theo lo·∫°i
  - Bi·ªÉu ƒë·ªì tr√≤n ph√¢n b·ªë t·ªìn kho
  - Th·ªëng k√™ t·ªïng quan (t·ªïng m·∫∑t h√†ng, h·∫øt h√†ng, t·ªìn kho th·∫•p)
  - Top 5 lo·∫°i c√≥ nhi·ªÅu h√†ng nh·∫•t
  - Xu·∫•t b√°o c√°o CSV

### 3. B√°o C√°o L·ª£i Nhu·∫≠n (`ProfitReport`)

- **M·ª•c ƒë√≠ch**: Ph√¢n t√≠ch l·ª£i nhu·∫≠n theo linh ki·ªán
- **Truy c·∫≠p**: `/LinhKien/ProfitReport`
- **T√≠nh nƒÉng**:
  - Top 10 linh ki·ªán c√≥ l·ª£i nhu·∫≠n cao nh·∫•t
  - Ph√¢n b·ªë l·ª£i nhu·∫≠n theo lo·∫°i
  - Th·ªëng k√™ t·ªïng l·ª£i nhu·∫≠n, doanh thu, chi ph√≠
  - T·ª∑ l·ªá l·ª£i nhu·∫≠n trung b√¨nh

## C√°ch S·ª≠ D·ª•ng

### Truy C·∫≠p C·∫£nh B√°o T·ªìn Kho

1. **T·ª´ trang danh s√°ch linh ki·ªán**:

   - Click n√∫t "C·∫£nh B√°o T·ªìn Kho" (m√†u v√†ng)
   - Ho·∫∑c truy c·∫≠p tr·ª±c ti·∫øp: `/LinhKien/LowStockAlert`

2. **T·ª´ sidebar**:
   - V√†o "Qu·∫£n L√Ω S·∫£n Ph·∫©m" ‚Üí "Linh Ki·ªán"
   - Click "C·∫£nh B√°o T·ªìn Kho"

### Thi·∫øt L·∫≠p Ng∆∞·ª°ng C·∫£nh B√°o

1. **Ng∆∞·ª°ng m·∫∑c ƒë·ªãnh**: 10 c√°i
2. **Thay ƒë·ªïi ng∆∞·ª°ng**:
   - Nh·∫≠p s·ªë v√†o √¥ "Ng∆∞·ª°ng c·∫£nh b√°o"
   - Click "L·ªçc"
   - Ho·∫∑c click c√°c n√∫t nhanh: ‚â§5, ‚â§10, ‚â§20, ‚â§50

### Nh·∫≠p H√†ng Nhanh

#### Nh·∫≠p T·ª´ng Linh Ki·ªán

1. Click n√∫t "+" (m√†u xanh) ƒë·ªÉ nh·∫≠p theo ƒë·ªÅ xu·∫•t
2. Click n√∫t "‚úèÔ∏è" (m√†u xanh d∆∞∆°ng) ƒë·ªÉ nh·∫≠p s·ªë l∆∞·ª£ng t√πy ch·ªçn
3. X√°c nh·∫≠n s·ªë l∆∞·ª£ng v√† th·ª±c hi·ªán

#### Nh·∫≠p H√†ng Lo·∫°t

1. Ch·ªçn c√°c linh ki·ªán c·∫ßn nh·∫≠p (checkbox)
2. Click "Nh·∫≠p H√†ng ƒê√£ Ch·ªçn"
3. Nh·∫≠p s·ªë l∆∞·ª£ng chung cho t·∫•t c·∫£
4. X√°c nh·∫≠n v√† th·ª±c hi·ªán

### Xu·∫•t B√°o C√°o

1. **Xu·∫•t danh s√°ch c·∫£nh b√°o**:

   - Click "Xu·∫•t Danh S√°ch" trong trang LowStockAlert
   - File CSV s·∫Ω ƒë∆∞·ª£c t·∫£i v·ªÅ

2. **Xu·∫•t b√°o c√°o t·ªìn kho**:

   - Click "Xu·∫•t B√°o C√°o" trong trang StockReport
   - File CSV ch·ª©a th·ªëng k√™ theo lo·∫°i

3. **Xu·∫•t b√°o c√°o l·ª£i nhu·∫≠n**:
   - Click "Xu·∫•t B√°o C√°o" trong trang ProfitReport
   - File CSV ch·ª©a chi ti·∫øt l·ª£i nhu·∫≠n

## M√†u S·∫Øc C·∫£nh B√°o

### Trong B·∫£ng D·ªØ Li·ªáu

- **üî¥ ƒê·ªè**: H·∫øt h√†ng (0 c√°i)
- **üü° V√†ng**: S·∫Øp h·∫øt (1-5 c√°i)
- **üîµ Xanh d∆∞∆°ng**: √çt h√†ng (6-20 c√°i)
- **üü¢ Xanh l√°**: C√≤n nhi·ªÅu (>20 c√°i)

### Trong Th·ªëng K√™

- **ƒê·ªè**: H·∫øt h√†ng
- **V√†ng**: T·ªìn kho th·∫•p
- **Xanh d∆∞∆°ng**: T·ªìn kho b√¨nh th∆∞·ªùng
- **Xanh l√°**: T·ªìn kho t·ªët

## C·∫•u Tr√∫c D·ªØ Li·ªáu

### Model LinhKien

```csharp
public class LinhKien
{
    public int MaLinhKien { get; set; }
    public string TenLinhKien { get; set; }
    public int MaLoaiLinhKien { get; set; }
    public string? HangSanXuat { get; set; }
    public decimal GiaNhap { get; set; }
    public decimal GiaBan { get; set; }
    public int SoLuongTon { get; set; }
    public string? ThongSoKyThuat { get; set; }
    public DateTime NgayTao { get; set; }
    public bool TrangThai { get; set; }

    // Navigation
    public virtual LoaiLinhKien? LoaiLinhKien { get; set; }

    // Computed properties
    public string TrangThaiTonKho { get; }
    public string TonKhoCssClass { get; }
    public decimal LoiNhuan { get; }
    public decimal TyLeLoiNhuan { get; }
}
```

### Services

- **ILinhKienService**: CRUD c∆° b·∫£n v√† t√¨m ki·∫øm
- **ILinhKienStatisticsService**: B√°o c√°o v√† th·ªëng k√™
- **ILinhKienValidationService**: Validation d·ªØ li·ªáu

## API Endpoints

### C·∫£nh B√°o T·ªìn Kho

```
GET /LinhKien/LowStockAlert?threshold=10
```

### B√°o C√°o T·ªìn Kho

```
GET /LinhKien/StockReport
```

### B√°o C√°o L·ª£i Nhu·∫≠n

```
GET /LinhKien/ProfitReport
```

### C·∫≠p Nh·∫≠t T·ªìn Kho (AJAX)

```
POST /LinhKien/UpdateStock
{
    "id": 1,
    "quantity": 10,
    "action": "add" // add, subtract, set
}
```

## T√πy Ch·ªânh

### Thay ƒê·ªïi Ng∆∞·ª°ng M·∫∑c ƒê·ªãnh

Trong `LinhKienController.cs`:

```csharp
public async Task<IActionResult> LowStockAlert(int threshold = 10)
```

### Thay ƒê·ªïi M√†u S·∫Øc

Trong `wwwroot/css/baocao.css`:

```css
.badge.bg-danger {
  /* H·∫øt h√†ng */
}
.badge.bg-warning {
  /* S·∫Øp h·∫øt */
}
.badge.bg-info {
  /* √çt h√†ng */
}
.badge.bg-success {
  /* C√≤n nhi·ªÅu */
}
```

### Th√™m Lo·∫°i C·∫£nh B√°o M·ªõi

Trong `Models/LinhKien.cs`:

```csharp
public string TrangThaiTonKho
{
    get
    {
        if (SoLuongTon == 0) return "H·∫øt h√†ng";
        if (SoLuongTon <= 5) return "S·∫Øp h·∫øt";
        if (SoLuongTon <= 20) return "√çt h√†ng";
        return "C√≤n h√†ng";
    }
}
```

## L∆∞u √ù Quan Tr·ªçng

1. **Backup d·ªØ li·ªáu**: Lu√¥n backup tr∆∞·ªõc khi th·ª±c hi·ªán nh·∫≠p h√†ng h√†ng lo·∫°t
2. **Ki·ªÉm tra gi√°**: ƒê·∫£m b·∫£o gi√° nh·∫≠p v√† gi√° b√°n h·ª£p l√Ω
3. **Theo d√µi ƒë·ªãnh k·ª≥**: Ki·ªÉm tra c·∫£nh b√°o t·ªìn kho h√†ng ng√†y
4. **C·∫≠p nh·∫≠t th√¥ng tin**: C·∫≠p nh·∫≠t gi√° v√† th√¥ng tin linh ki·ªán th∆∞·ªùng xuy√™n

## H·ªó Tr·ª£

N·∫øu g·∫∑p v·∫•n ƒë·ªÅ ho·∫∑c c·∫ßn h·ªó tr·ª£:

1. Ki·ªÉm tra log l·ªói trong console
2. X√°c nh·∫≠n k·∫øt n·ªëi database
3. Ki·ªÉm tra quy·ªÅn truy c·∫≠p file
4. Li√™n h·ªá admin ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£
